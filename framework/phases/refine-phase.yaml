    - pitfall: "Voice Inconsistency"
      description: "Introducing inconsistent voice or tone during revisions"
      prevention:
        - "Maintain consistent voice across original and new content"
        - "Check revised sections for voice alignment with surrounding content"
        - "Ensure authentic voice throughout all revisions"
    
    - pitfall: "Structure Disruption"
      description: "Changes that break the logical flow or organization"
      prevention:
        - "Verify section transitions after revisions"
        - "Ensure content still follows logical progression"
        - "Maintain proper formatting throughout changes"# refine.yaml
# Framework for the Refinement phase of the Amazon Review Framework

# =============================================================================
# Phase Overview
# =============================================================================
phase_overview:
  description: "The Refinement phase collaboratively improves the review based on user feedback"
  critical_requirement:
    priority: "HIGH"
    instruction: "Make targeted improvements while maintaining framework compliance"
    rationale: "Revisions should enhance rather than compromise review quality"
  objectives:
    - "Implement user-requested improvements to the review draft"
    - "Maintain framework compliance during the revision process"
    - "Ensure all changes preserve the authentic voice and experience"
    - "Address specific areas for enhancement identified by the user"
    - "Improve overall quality while preserving the draft's strengths"
  success_criteria:
    - "All user feedback has been effectively addressed"
    - "Revisions maintain or improve framework compliance"
    - "Information/personality balance remains appropriate"
    - "Authentic voice is preserved throughout all revisions"
    - "User confirms satisfaction with the refined review"

# =============================================================================
# Feedback Processing
# =============================================================================
feedback_processing:
  description: "Framework for effectively processing and implementing user feedback"
  
  feedback_categories:
    - name: "Content Addition"
      description: "Requests to add new information not in the original draft"
      implementation_approach:
        - "Identify optimal placement within existing structure"
        - "Integrate new content while maintaining section flow"
        - "Apply appropriate information/personality balance"
        - "Ensure additions don't create redundancy with existing content"
    
    - name: "Content Removal"
      description: "Requests to remove or reduce content in the draft"
      implementation_approach:
        - "Remove specified content completely if requested"
        - "Verify removal doesn't create logical gaps or flow issues"
        - "Adjust surrounding content for smooth transitions"
        - "Ensure critical information isn't inadvertently removed"
    
    - name: "Style Adjustment"
      description: "Requests to modify the tone, voice, or personality level"
      implementation_approach:
        - "Adjust personality ratio while maintaining framework compliance"
        - "Modify creative elements while preserving authentic experience"
        - "Ensure changes maintain the review's overall coherence"
        - "Preserve information value while adjusting style"
    
    - name: "Structure Modification"
      description: "Requests to reorganize or reformat the review"
      implementation_approach:
        - "Implement structural changes while maintaining logical flow"
        - "Ensure section transitions remain smooth after reorganization"
        - "Verify all content still fits appropriate sections"
        - "Maintain proper formatting throughout modifications"
    
    - name: "Emphasis Change"
      description: "Requests to highlight different aspects of the product"
      implementation_approach:
        - "Adjust content prominence based on requested emphasis"
        - "Maintain balanced evaluation despite emphasis shifts"
        - "Ensure changes reflect the authentic experience"
        - "Verify emphasis changes don't create misrepresentation"

  implementation_process:
    - step: "Categorize feedback"
      description: "Identify the specific type of change requested"
      implementation:
        - "Analyze user feedback for specific change requests"
        - "Categorize each request using the feedback categories framework"
        - "Prioritize changes that impact review quality most significantly"
    
    - step: "Map feedback to framework elements"
      description: "Connect each requested change to relevant framework components"
      implementation:
        - "Identify which framework elements are affected by each request"
        - "Reference appropriate guidelines for implementation"
        - "Note any potential conflicts with framework principles"
    
    - step: "Plan coordinated implementation"
      description: "Develop a comprehensive approach to all requested changes"
      implementation:
        - "Determine optimal sequence for implementing changes"
        - "Identify interdependencies between requested changes"
        - "Plan approach that maintains overall review coherence"
    
    - step: "Execute targeted revisions"
      description: "Make specific changes while preserving overall quality"
      implementation:
        - "Implement changes according to plan"
        - "Maintain framework compliance throughout revisions"
        - "Verify changes effectively address user feedback"
    
    - step: "Verify implementation quality"
      description: "Ensure all changes maintain or improve review quality"
      implementation:
        - "Review all changes for framework compliance"
        - "Check information/personality balance after revisions"
        - "Verify authentic voice is maintained throughout"
        - "Ensure all requested changes have been implemented"

# =============================================================================
# Revision Strategy
# =============================================================================
revision_strategy:
  description: "Strategic approach to implementing revisions effectively"
  
  revision_principles:
    - "Make the smallest changes necessary to address feedback"
    - "Preserve authentic experience while implementing revisions"
    - "Maintain coherent structure and flow throughout changes"
    - "Ensure revisions enhance rather than detract from review quality"
    - "Keep information/personality balance within target ranges"
  
  implementation_techniques:
    - name: "Targeted Section Revisions"
      description: "Modify specific sections while preserving others"
      application:
        - "Identify sections directly affected by feedback"
        - "Make precise changes to those sections only"
        - "Verify section transitions remain smooth after changes"
      example:
        request: "Add more information about battery life"
        implementation: "Enhance Technical Details section with battery performance data"
    
    - name: "Content Rebalancing"
      description: "Adjust emphasis among existing content elements"
      application:
        - "Identify content that needs more or less prominence"
        - "Reposition or reframe content to adjust emphasis"
        - "Maintain overall flow and logical progression"
      example:
        request: "The durability issues should be more prominent"
        implementation: "Move durability concerns earlier in CONS list and expand detail"
    
    - name: "Style Refinement"
      description: "Adjust tone or personality while preserving content"
      application:
        - "Modify personality ratio in targeted sections"
        - "Adjust creative elements to match requested style"
        - "Maintain authentic voice despite style changes"
      example:
        request: "Make the introduction less humorous"
        implementation: "Reduce personality ratio in introduction while preserving core information"
    
    - name: "Structural Enhancement"
      description: "Improve organization while preserving content"
      application:
        - "Reorganize sections for better logical flow"
        - "Add clarifying transitions between sections"
        - "Improve formatting for better visual organization"
      example:
        request: "The pros and cons need more structure"
        implementation: "Organize pros and cons into subcategories with clearer formatting"

  coordination_strategies:
    - strategy: "Single Comprehensive Revision"
      description: "Implement all changes in a single coordinated update"
      best_for: "Multiple related changes affecting overall review"
      implementation:
        - "Analyze all feedback holistically before making changes"
        - "Plan comprehensive approach that addresses all feedback"
        - "Implement changes in logical sequence"
        - "Present complete revised version rather than incremental updates"
    
    - strategy: "Iterative Refinement"
      description: "Implement changes in stages with user feedback between iterations"
      best_for: "Complex revisions requiring user confirmation at multiple stages"
      implementation:
        - "Prioritize changes by significance and dependency"
        - "Implement highest-priority changes first"
        - "Seek confirmation before proceeding to next changes"
        - "Present complete context with each iteration"

# =============================================================================
# Quality Assurance
# =============================================================================
quality_assurance:
  description: "Framework for maintaining quality throughout the refinement process"
  
  post_revision_checks:
    - check: "Feedback Implementation Verification"
      method: "Confirm all user feedback has been addressed"
      acceptance: "Each specific feedback point has been implemented or addressed"
    
    - check: "Framework Compliance"
      method: "Verify revisions maintain compliance with framework principles"
      acceptance: "All changes align with core framework guidelines"
    
    - check: "Information/Personality Balance"
      method: "Check balance ratios after revisions"
      acceptance: "All sections remain within 5% of target ratios"
    
    - check: "Authentic Voice Preservation"
      method: "Verify authentic voice throughout revised content"
      acceptance: "No marketing-style language or manufactured enthusiasm introduced"
    
    - check: "Content Flow"
      method: "Evaluate logical progression and transitions after revisions"
      acceptance: "Content maintains coherent flow and smooth transitions"
    
    - check: "Keyword Integration"
      method: "Verify keywords remain effectively integrated"
      acceptance: "Changes don't disrupt strategic keyword placement"
  
  revision_pitfalls:
    - pitfall: "Feedback Over-Implementation"
      description: "Making changes that go beyond what was requested"
      prevention:
        - "Stick closely to specific feedback provided"
        - "Seek clarification for ambiguous feedback"
        - "Verify changes directly address the feedback"
    
    - pitfall: "Framework Deviation"
      description: "Implementing changes that violate framework principles"
      prevention:
        - "Cross-check all changes against framework guidelines"
        - "Prioritize framework compliance during implementation"
        - "Find alternative implementations that satisfy both feedback and framework"
    
    - pitfall: "Balance Disruption"
      description: "Losing personality when fixing complexity issues, or vice versa"
      prevention:
        - "Address complexity issues while preserving key personality elements"
        - "Identify the tone and personality style to preserve, not specific phrases"
        - "When information needs changing, recreate personality elements that match the original style"
        - "Focus on maintaining the overall voice and tone rather than specific jokes or analogies"
        - "When adding personality, ensure it enhances rather than complicates information"
        - "Maintain proper information-to-personality ratio during all revisions"
        - "Make targeted changes that preserve the review's overall voice and clarity"
      examples:
        - scenario: "Simplification removes all personality"
          problematic: "Removing redundant descriptions also eliminates all humor and voice"
          improved: "Consolidating information while preserving key metaphors and personality touches"
        - scenario: "Personality additions increase complexity"
          problematic: "Adding creative elements that obscure the core information"
          improved: "Integrating personality that enhances understanding without increasing complexity"

# =============================================================================
# User Collaboration
# =============================================================================
user_collaboration:
  description: "Framework for effective collaboration with the user during refinement"
  
  clarification_strategies:
    - strategy: "Focused Clarification Requests"
      description: "Ask specific questions about ambiguous feedback"
      example:
        feedback: "Make it more detailed"
        clarification: "Would you like more technical specifications, more usage examples, or more comparisons to alternatives?"
    
    - strategy: "Option Presentation"
      description: "Present alternative implementation approaches for user selection"
      example:
        feedback: "Tone down the humor"
        options:
          - "Reduce humor throughout the entire review"
          - "Focus humor in specific sections only"
          - "Replace humor with more straightforward descriptions"
    
    - strategy: "Implementation Preview"
      description: "Describe planned changes before full implementation"
      example:
        feedback: "Reorganize the structure"
        preview: "I plan to move the technical details before the user experience section, and create separate subcategories for pros and cons. Does this address your feedback?"
  
  feedback_integration_guidance:
    - "Acknowledge all feedback explicitly before implementation"
    - "Explain implementation approach for complex changes"
    - "Highlight any constraints or tradeoffs in addressing feedback"
    - "Seek confirmation for major structural or tonal changes"
    - "Provide reasoning when framework requirements limit certain changes"

# =============================================================================
# Transition Requirements
# =============================================================================
transition_requirements:
  description: "Criteria that must be met before transitioning to the Quality Control phase"
  
  mandatory_requirements:
    - requirement: "All user feedback has been addressed"
      validation: "Verify each specific feedback point has been implemented or addressed"
    
    - requirement: "User confirms satisfaction with revisions"
      validation: "Explicit confirmation that the refinements meet expectations"
    
    - requirement: "Review maintains framework compliance"
      validation: "Confirm all post-revision quality checks are passed"
    
    - requirement: "No outstanding issues or concerns remain"
      validation: "Verify all identified issues have been resolved"
  
  completion_checklist:
    - "All requested content additions have been implemented"
    - "All requested content removals have been completed"
    - "All style adjustments have been applied appropriately"
    - "All structure modifications maintain logical flow"
    - "All emphasis changes accurately reflect user priorities"
    - "Information/personality balance remains appropriate throughout"
    - "Authentic voice is preserved across all revised content"
    - "User has explicitly confirmed satisfaction with revisions"

# =============================================================================
# API Implementation Guidance
# =============================================================================
api_implementation:
  description: "Guidelines for implementing the Refinement phase in an API"
  
  system_prompt_components:
    - "Include feedback processing framework"
    - "Include revision strategy guidelines"
    - "Include quality assurance checks"
    - "Include user collaboration guidance"
  
  message_structure:
    - order: 1
      type: "Feedback acknowledgment"
      content: "Explicit acknowledgment of all feedback received"
    
    - order: 2
      type: "Implementation plan"
      content: "Brief explanation of planned changes to address feedback"
    
    - order: 3
      type: "Revised review"
      content: "Complete updated review incorporating all changes"
    
    - order: 4
      type: "Quality verification"
      content: "Confirmation that quality checks have been passed"
    
    - order: 5
      type: "Satisfaction check"
      content: "Request for confirmation that revisions are satisfactory"
  
  processing_steps:
    - "Analyze and categorize user feedback"
    - "Map feedback to relevant framework components"
    - "Plan coordinated implementation approach"
    - "Execute targeted revisions while maintaining quality"
    - "Perform all post-revision quality checks"
    - "Present revised review with explanation of changes"
    - "Confirm user satisfaction before transitioning"
  
  versioning_approach:
    - "Track review versions through refinement iterations"
    - "Store complete review at each major revision point"
    - "Maintain record of specific changes made in each version"
    - "Enable comparison between versions if needed"
  
  error_handling:
    - scenario: "Conflicting feedback"
      response: "Identify conflicts and seek clarification on priorities"
    
    - scenario: "Framework-incompatible requests"
      response: "Explain constraints and offer alternative implementations"
    
    - scenario: "Ambiguous feedback"
      response: "Seek specific clarification before implementation"
    
    - scenario: "User dissatisfaction with revisions"
      response: "Identify specific issues and implement additional changes"